import textwrap


class MalwareSample:
    """Represents a Generic Malware Sample with detection results."""

    def __init__(self, file_name, file_hash, detection_result):
        self.file_name = file_name
        self.file_hash = file_hash
        self.detection_result = detection_result

    def get_info(self):
        return textwrap.dedent(
            f"""
            Filename: '{self.file_name}' 
            Hash '{self.file_hash}'
            Detection result: {self.detection_result}
            """
        )

    def display_info(self):
        print(self.get_info())

    def is_detected(self):
        return self.detection_result

    @classmethod
    def from_dict(cls, data_dict):
        return cls(
            data_dict["file_name"],
            data_dict["file_hash"],
            data_dict["detection_result"],
        )

    @staticmethod
    def validate_hash(hash):
        if not hash:
            return "Hash is not valid"
        return "Hash is valid"

    def __str__(self):
        return f"MalwareSample: {self.file_name} Detected: {self.detection_result}"


class PEMalwareSample(MalwareSample):
    """Represents a Portable Executable (PE) Malware Sample."""

    def __init__(self, file_name, file_hash, detection_result, pe_sections=None):
        super().__init__(file_name, file_hash, detection_result)
        self.pe_sections = pe_sections or []

    def get_info(self):
        base_info = super().get_info()
        return f"{base_info}Sections: {self.pe_sections}"

    def __str__(self):
        return f"PEMalwareSample: {self.file_name} Detected: {self.detection_result} Sections: {len(self.pe_sections)}"


class WebMalwareSample(MalwareSample):
    """Represents a Web Malware Sample."""

    def __init__(self, file_name, file_hash, detection_result, url):
        super().__init__(file_name, file_hash, detection_result)
        self.url = url

    def get_info(self):
        base_info = super().get_info()
        return f"{base_info}URL: {self.url}"

    def __str__(self):
        return f"WebMalwareSample: {self.file_name} Detected: {self.detection_result} Url: {self.url}"
